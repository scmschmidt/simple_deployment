#!/bin/bash

set -e
LANG=C

# Include shared functions.
. "${0%*${0##*/}}include"

# Get current status.
status=$(< "${status_file}")

# A reboot is only triggered, if the status is set to `baseline_set`.
[ "${status}" != 'baseline_set'  ] && exit_on_error "Invalid status for reboot: ${status}"

# Reboot if necessary (the working BASELINE snapshot is not the active one).
update_ss_vars
if [ "${ss_working_baseline}" == "${ss_active}" ] ; then
    log "The working BASELINE snapshot (${ss_working_baseline}) is already active. No reboot required."
    exit 0
fi
reboot

